<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>WebRTC Insertable Media using Streams</title>
  <meta content="DREAM" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2016/W3C-DREAM" rel="stylesheet">
  <link href="https://www.w3.org/2008/site/images/favicon.ico" rel="icon">
  <meta content="Bikeshed version 86a39676f08870ba1210b97fe65ff62bd4e723c9" name="generator">
  <link href="https://alvestrand.github.io/webrtc-media-streams/" rel="canonical">
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-selflinks */

.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: gray;
    color: white;
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: black;
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: #005a9c;
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
<style>/* style-dfn-panel */

.dfn-panel {
    position: absolute;
    z-index: 35;
    height: auto;
    width: -webkit-fit-content;
    width: fit-content;
    max-width: 300px;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: #DDDDDD;
    color: black;
    border: outset 0.2em;
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: black; }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-syntax-highlighting */
pre.idl.highlight { color: #708090; }
.highlight:not(.idl) { background: hsl(24, 20%, 95%); }
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">WebRTC Insertable Media using Streams</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">A Collection of Interesting Ideas, <time class="dt-updated" datetime="2019-10-14">14 October 2019</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://alvestrand.github.io/webrtc-media-streams/">https://alvestrand.github.io/webrtc-media-streams/</a>
     <dt>Feedback:
     <dd><span><a href="mailto:public-webrtc@w3.org?subject=%5Bwebrtc-media-streams%5D%20YOUR%20TOPIC%20HERE">public-webrtc@w3.org</a> with subject line “<kbd>[webrtc-media-streams] <i data-lt>… message topic …</i></kbd>” (<a href="https://lists.w3.org/Archives/Public/public-webrtc/" rel="discussion">archives</a>)</span>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:hta@google.com">Harald Alvestrand</a> (<a class="p-org org" href="https://google.com">Google</a>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2019 <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">Keio</a>, <a href="https://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This API defines an API surface for manipulating the bits on

MediaStreamTracks being sent via an RTCPeerConnection.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#introduction"><span class="secno">1</span> <span class="content">Introduction {#introduction}</span></a>
    <li><a href="#terminology"><span class="secno">2</span> <span class="content">Terminology {#terminology}</span></a>
    <li>
     <a href="#specification"><span class="secno">3</span> <span class="content">Specification {#specification}</span></a>
     <ol class="toc">
      <li><a href="#operation"><span class="secno">3.1</span> <span class="content">Extension operation {#operation}</span></a>
     </ol>
    <li><a href="#privacy"><span class="secno">4</span> <span class="content">Privacy and security considerations {#privacy}</span></a>
    <li><a href="#examples"><span class="secno">5</span> <span class="content">Examples {#examples}</span></a>
    <li><a href="#conformance"><span class="secno"></span> <span class="content"> Conformance</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction {#introduction}</span><a class="self-link" href="#introduction"></a></h2>
   <p>The <a data-link-type="biblio" href="#biblio-webrtc-nv-use-cases">[WEBRTC-NV-USE-CASES]</a> document describes several functions that
can only be achieved by access to media (requirements N20-N22),
including, but not limited to:</p>
   <ul>
    <li data-md>
     <p>Funny Hats</p>
    <li data-md>
     <p>Machine Learning</p>
    <li data-md>
     <p>Virtual Reality Gaming</p>
   </ul>
   <p>These use cases further require that processing can be done in worker
threads (requirement N23-N24).</p>
   <p>Furthermore, the "trusted JavaScript cloud conferencing" use case
requires such processing to be done on encoded media, not just the raw
media.</p>
   <p>This specification gives an interface that builds on <a data-link-type="biblio" href="#biblio-web-codecs">[WEB-CODECS]</a> to
provide access to such functionality while retaining the setup flow of
RTCPeerConnection.</p>
   <h2 class="heading settled" data-level="2" id="terminology"><span class="secno">2. </span><span class="content">Terminology {#terminology}</span><a class="self-link" href="#terminology"></a></h2>
   <p> The IDL terms <dfn data-dfn-type="dfn" data-noexport id="audioencoder" type="idl-name">AudioEncoder<a class="self-link" href="#audioencoder"></a></dfn>, <dfn data-dfn-type="dfn" data-noexport id="videoencoder">VideoEncoder<a class="self-link" href="#videoencoder"></a></dfn>, <dfn data-dfn-type="dfn" data-noexport id="audiodecoder">AudioDecoder<a class="self-link" href="#audiodecoder"></a></dfn>, <dfn data-dfn-type="dfn" data-noexport id="videodecoder">VideoDecoder<a class="self-link" href="#videodecoder"></a></dfn> are defined in <a data-link-type="biblio" href="#biblio-web-codecs">[WEB-CODECS]</a>. </p>
   <h2 class="heading settled" data-level="3" id="specification"><span class="secno">3. </span><span class="content">Specification {#specification}</span><a class="self-link" href="#specification"></a></h2>
   <p>The Streams definition doesn’t use WebIDL much, but the WebRTC spec does.
This specification shows the IDL extensions for WebRTC.</p>
   <p>It uses an extension to RTCConfiguration in order to pass the extra
decorators for encoder and decoder initialization to an <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcpeerconnection" id="ref-for-dom-rtcpeerconnection">RTCPeerConnection</a></code>.</p>
<pre class="idl highlight def"><c- b>typedef</c-> (<a class="n" data-link-type="idl-name" href="https://github.com/WICG/web-codecs/#dom-audioencoder" id="ref-for-dom-audioencoder"><c- n>AudioEncoder</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="https://github.com/WICG/web-codecs/#dom-videoencoder" id="ref-for-dom-videoencoder"><c- n>VideoEncoder</c-></a>) <dfn class="dfn-paneled idl-code" data-dfn-type="typedef" data-export id="typedefdef-encoder"><code><c- g>Encoder</c-></code></dfn>;
<c- b>typedef</c-> (<a class="n" data-link-type="idl-name" href="https://github.com/WICG/web-codecs/#dom-audiodecoder" id="ref-for-dom-audiodecoder"><c- n>AudioDecoder</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="https://github.com/WICG/web-codecs/#dom-videodecoder" id="ref-for-dom-videodecoder"><c- n>VideoDecoder</c-></a>) <dfn class="dfn-paneled idl-code" data-dfn-type="typedef" data-export id="typedefdef-decoder"><code><c- g>Decoder</c-></code></dfn>;

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-config"><code><c- g>Config</c-></code></dfn> {
  // To Be Defined
};  

<c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-encoderdecorator"><code><c- g>EncoderDecorator</c-></code></dfn> = <a class="n" data-link-type="idl-name" href="#typedefdef-encoder" id="ref-for-typedefdef-encoder"><c- n>Encoder</c-></a>(<a class="n" data-link-type="idl-name" href="#typedefdef-encoder" id="ref-for-typedefdef-encoder①"><c- n>Encoder</c-></a> <dfn class="idl-code" data-dfn-for="EncoderDecorator" data-dfn-type="argument" data-export id="dom-encoderdecorator-encoder"><code><c- g>encoder</c-></code><a class="self-link" href="#dom-encoderdecorator-encoder"></a></dfn>, <c- b>optional</c-> <a class="n" data-link-type="idl-name" href="#dictdef-config" id="ref-for-dictdef-config"><c- n>Config</c-></a> <dfn class="idl-code" data-dfn-for="EncoderDecorator" data-dfn-type="argument" data-export id="dom-encoderdecorator-config"><code><c- g>config</c-></code><a class="self-link" href="#dom-encoderdecorator-config"></a></dfn>);
<c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-decoderdecorator"><code><c- g>DecoderDecorator</c-></code></dfn> = <a class="n" data-link-type="idl-name" href="#typedefdef-decoder" id="ref-for-typedefdef-decoder"><c- n>Decoder</c-></a>(<a class="n" data-link-type="idl-name" href="#typedefdef-decoder" id="ref-for-typedefdef-decoder①"><c- n>Decoder</c-></a> <dfn class="idl-code" data-dfn-for="DecoderDecorator" data-dfn-type="argument" data-export id="dom-decoderdecorator-encoder"><code><c- g>encoder</c-></code><a class="self-link" href="#dom-decoderdecorator-encoder"></a></dfn>, <c- b>optional</c-> <a class="n" data-link-type="idl-name" href="#dictdef-config" id="ref-for-dictdef-config①"><c- n>Config</c-></a> <dfn class="idl-code" data-dfn-for="DecoderDecorator" data-dfn-type="argument" data-export id="dom-decoderdecorator-config"><code><c- g>config</c-></code><a class="self-link" href="#dom-decoderdecorator-config"></a></dfn>);

<c- b>partial</c-> <c- b>dictionary</c-> <a class="idl-code" data-link-type="dictionary" href="https://w3c.github.io/webrtc-pc/#dom-rtcconfiguration" id="ref-for-dom-rtcconfiguration"><c- g>RTCConfiguration</c-></a> {
   <a class="n" data-link-type="idl-name" href="#callbackdef-encoderdecorator" id="ref-for-callbackdef-encoderdecorator"><c- n>EncoderDecorator</c-></a> <dfn class="idl-code" data-dfn-for="RTCConfiguration" data-dfn-type="dict-member" data-export data-type="EncoderDecorator " id="dom-rtcconfiguration-encoderfactory"><code><c- g>encoderFactory</c-></code><a class="self-link" href="#dom-rtcconfiguration-encoderfactory"></a></dfn>;
   <a class="n" data-link-type="idl-name" href="#callbackdef-decoderdecorator" id="ref-for-callbackdef-decoderdecorator"><c- n>DecoderDecorator</c-></a> <dfn class="idl-code" data-dfn-for="RTCConfiguration" data-dfn-type="dict-member" data-export data-type="DecoderDecorator " id="dom-rtcconfiguration-decoderfactory"><code><c- g>decoderFactory</c-></code><a class="self-link" href="#dom-rtcconfiguration-decoderfactory"></a></dfn>;
};
</pre>
   <h3 class="heading settled" data-level="3.1" id="operation"><span class="secno">3.1. </span><span class="content">Extension operation {#operation}</span><a class="self-link" href="#operation"></a></h3>
    At creation of an RTCPeerConnection, the following steps are added to
the creation algorithm: 
   <ul>
    <li data-md>
     <p>Let the RTCPeerConnection object have two internal slots named [[\EncoderFactory]] and [[\DecoderFactory]], initialized to null.</p>
    <li data-md>
     <p>If the RTCConfiguration parameter contains a value for "encoderFactory", store that in [[\EncoderFactory]].</p>
    <li data-md>
     <p>If the RTCConfiguration parameter contains a value for "decoderFactory", store that in [[\DecoderFactory]].</p>
   </ul>
   <p>At the time when a codec is initialized as part of the encoder, run
the following steps:</p>
   <ul>
    <li data-md>
     <p>If the unencoded data source does not permit access, abort these steps. (OPEN ISSUE: How is this error surfaced?)</p>
    <li data-md>
     <p>Let the unencoded data source be represented by a ReadableStream called "source".</p>
    <li data-md>
     <p>Let the encoded data sink be represented by a WriteableStream called</p>
    <li data-md>
     <p>"sink".</p>
    <li data-md>
     <p>Let the internal encoder object be called "internalEncoder". "internalEncoder" will have a WritableStream property called "writable" (by virtue of being an instance of WebCodec).</p>
    <li data-md>
     <p>"internalEncoder" will have a ReadableStream property called "readable".</p>
    <li data-md>
     <p>If the PeerConnection’s [[\EncoderFactory]] is null, pipe "source" to "writable", and pipe "readable" to "sink", and skip the rest of these steps.</p>
    <li data-md>
     <p>Call the function stored in [[\EncoderFactory]], using the newly initialized encoder and its parameters as arguments.</p>
    <li data-md>
     <p>Let the return value from the function be "encoder".</p>
    <li data-md>
     <p>If "encoder" has an attribute "readable", pipe it to "sink". Otherwise, pipe the "internalEncoder"'s "readable" to "sink".</p>
    <li data-md>
     <p>If "encoder" has an attribute "writable", pipe "source" to it. Otherwise, pipe "source" to the "internalEncoder"'s "writable".</p>
   </ul>
   <p>The media will then be processed according to the rules of <a data-link-type="biblio" href="#biblio-web-codecs">[WEB-CODECS]</a>.</p>
   <h2 class="heading settled" data-level="4" id="privacy"><span class="secno">4. </span><span class="content">Privacy and security considerations {#privacy}</span><a class="self-link" href="#privacy"></a></h2>
   <p>This API gives Javascript access to the content of media streams. This
is also available from other sources, such as Canvas and WebAudio.</p>
   <p>However, streams that are isolated (as specified in <a data-link-type="biblio" href="#biblio-webrtc-identity">[WEBRTC-IDENTITY]</a>) or tainted with another origin, cannot be
accessed using this API, since that would break the isolation rule.</p>
   <h2 class="heading settled" data-level="5" id="examples"><span class="secno">5. </span><span class="content">Examples {#examples}</span><a class="self-link" href="#examples"></a></h2>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="conformance"><span class="content"> Conformance</span><a class="self-link" href="#conformance"></a></h2>
   <p> Conformance requirements are expressed with a combination of descriptive assertions and RFC 2119 terminology.
            The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
            in the normative parts of this document
            are to be interpreted as described in RFC 2119.
            However, for readability,
            these words do not appear in all uppercase letters in this specification. </p>
   <p> All of the text of this specification is normative
            except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a> </p>
   <p> Examples in this specification are introduced with the words “for example”
            or are set apart from the normative text with <code>class="example"</code>, like this: </p>
   <div class="example" id="example-example"><a class="self-link" href="#example-example"></a> This is an example of an informative example. </div>
   <p> Informative notes begin with the word “Note”
            and are set apart from the normative text with <code>class="note"</code>, like this: </p>
   <p class="note" role="note"> Note, this is an informative note. </p>
  </div>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">←</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">→</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">↑</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Don’t scroll to compensate for the ToC if we’re above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I don’t know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldn’t exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isn’t standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we don’t have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While we’re at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Can’t find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#audiodecoder">AudioDecoder</a><span>, in §2</span>
   <li><a href="#audioencoder">AudioEncoder</a><span>, in §2</span>
   <li><a href="#dictdef-config">Config</a><span>, in §3</span>
   <li><a href="#typedefdef-decoder">Decoder</a><span>, in §3</span>
   <li><a href="#callbackdef-decoderdecorator">DecoderDecorator</a><span>, in §3</span>
   <li><a href="#dom-rtcconfiguration-decoderfactory">decoderFactory</a><span>, in §3</span>
   <li><a href="#typedefdef-encoder">Encoder</a><span>, in §3</span>
   <li><a href="#callbackdef-encoderdecorator">EncoderDecorator</a><span>, in §3</span>
   <li><a href="#dom-rtcconfiguration-encoderfactory">encoderFactory</a><span>, in §3</span>
   <li><a href="#videodecoder">VideoDecoder</a><span>, in §2</span>
   <li><a href="#videoencoder">VideoEncoder</a><span>, in §2</span>
  </ul>
  <aside class="dfn-panel" data-for="term-for-dom-audiodecoder">
   <a href="https://github.com/WICG/web-codecs/#dom-audiodecoder">https://github.com/WICG/web-codecs/#dom-audiodecoder</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-audiodecoder">3. Specification {#specification}</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-audioencoder">
   <a href="https://github.com/WICG/web-codecs/#dom-audioencoder">https://github.com/WICG/web-codecs/#dom-audioencoder</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-audioencoder">3. Specification {#specification}</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-videodecoder">
   <a href="https://github.com/WICG/web-codecs/#dom-videodecoder">https://github.com/WICG/web-codecs/#dom-videodecoder</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-videodecoder">3. Specification {#specification}</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-videoencoder">
   <a href="https://github.com/WICG/web-codecs/#dom-videoencoder">https://github.com/WICG/web-codecs/#dom-videoencoder</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-videoencoder">3. Specification {#specification}</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-rtcconfiguration">
   <a href="https://w3c.github.io/webrtc-pc/#dom-rtcconfiguration">https://w3c.github.io/webrtc-pc/#dom-rtcconfiguration</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-rtcconfiguration">3. Specification {#specification}</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-rtcpeerconnection">
   <a href="https://w3c.github.io/webrtc-pc/#dom-rtcpeerconnection">https://w3c.github.io/webrtc-pc/#dom-rtcpeerconnection</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-rtcpeerconnection">3. Specification {#specification}</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[WEB-CODECS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-dom-audiodecoder" style="color:initial">AudioDecoder</span>
     <li><span class="dfn-paneled" id="term-for-dom-audioencoder" style="color:initial">AudioEncoder</span>
     <li><span class="dfn-paneled" id="term-for-dom-videodecoder" style="color:initial">VideoDecoder</span>
     <li><span class="dfn-paneled" id="term-for-dom-videoencoder" style="color:initial">VideoEncoder</span>
    </ul>
   <li>
    <a data-link-type="biblio">[webrtc]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-dom-rtcconfiguration" style="color:initial">RTCConfiguration</span>
     <li><span class="dfn-paneled" id="term-for-dom-rtcpeerconnection" style="color:initial">RTCPeerConnection</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-web-codecs">[WEB-CODECS]
   <dd><a href="https://github.com/WICG/web-codecs/blob/master/explainer.md">Web Codecs explainer</a>. URL: <a href="https://github.com/WICG/web-codecs/blob/master/explainer.md">https://github.com/WICG/web-codecs/blob/master/explainer.md</a>
   <dt id="biblio-webrtc">[WEBRTC]
   <dd>Adam Bergkvist; et al. <a href="https://www.w3.org/TR/webrtc/">WebRTC 1.0: Real-time Communication Between Browsers</a>. 27 September 2018. CR. URL: <a href="https://www.w3.org/TR/webrtc/">https://www.w3.org/TR/webrtc/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-webrtc-identity">[WEBRTC-IDENTITY]
   <dd>Cullen Jennings; Martin Thomson. <a href="https://www.w3.org/TR/webrtc-identity/">Identity for WebRTC 1.0</a>. 27 September 2018. CR. URL: <a href="https://www.w3.org/TR/webrtc-identity/">https://www.w3.org/TR/webrtc-identity/</a>
   <dt id="biblio-webrtc-nv-use-cases">[WEBRTC-NV-USE-CASES]
   <dd>Bernard Aboba. <a href="https://www.w3.org/TR/webrtc-nv-use-cases/">WebRTC Next Version Use Cases</a>. 11 December 2018. WD. URL: <a href="https://www.w3.org/TR/webrtc-nv-use-cases/">https://www.w3.org/TR/webrtc-nv-use-cases/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def"><c- b>typedef</c-> (<a class="n" data-link-type="idl-name" href="https://github.com/WICG/web-codecs/#dom-audioencoder" id="ref-for-dom-audioencoder①"><c- n>AudioEncoder</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="https://github.com/WICG/web-codecs/#dom-videoencoder" id="ref-for-dom-videoencoder①"><c- n>VideoEncoder</c-></a>) <a href="#typedefdef-encoder"><code><c- g>Encoder</c-></code></a>;
<c- b>typedef</c-> (<a class="n" data-link-type="idl-name" href="https://github.com/WICG/web-codecs/#dom-audiodecoder" id="ref-for-dom-audiodecoder①"><c- n>AudioDecoder</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="https://github.com/WICG/web-codecs/#dom-videodecoder" id="ref-for-dom-videodecoder①"><c- n>VideoDecoder</c-></a>) <a href="#typedefdef-decoder"><code><c- g>Decoder</c-></code></a>;

<c- b>dictionary</c-> <a href="#dictdef-config"><code><c- g>Config</c-></code></a> {
  // To Be Defined
};  

<c- b>callback</c-> <a href="#callbackdef-encoderdecorator"><code><c- g>EncoderDecorator</c-></code></a> = <a class="n" data-link-type="idl-name" href="#typedefdef-encoder" id="ref-for-typedefdef-encoder②"><c- n>Encoder</c-></a>(<a class="n" data-link-type="idl-name" href="#typedefdef-encoder" id="ref-for-typedefdef-encoder①①"><c- n>Encoder</c-></a> <a href="#dom-encoderdecorator-encoder"><code><c- g>encoder</c-></code></a>, <c- b>optional</c-> <a class="n" data-link-type="idl-name" href="#dictdef-config" id="ref-for-dictdef-config②"><c- n>Config</c-></a> <a href="#dom-encoderdecorator-config"><code><c- g>config</c-></code></a>);
<c- b>callback</c-> <a href="#callbackdef-decoderdecorator"><code><c- g>DecoderDecorator</c-></code></a> = <a class="n" data-link-type="idl-name" href="#typedefdef-decoder" id="ref-for-typedefdef-decoder②"><c- n>Decoder</c-></a>(<a class="n" data-link-type="idl-name" href="#typedefdef-decoder" id="ref-for-typedefdef-decoder①①"><c- n>Decoder</c-></a> <a href="#dom-decoderdecorator-encoder"><code><c- g>encoder</c-></code></a>, <c- b>optional</c-> <a class="n" data-link-type="idl-name" href="#dictdef-config" id="ref-for-dictdef-config①①"><c- n>Config</c-></a> <a href="#dom-decoderdecorator-config"><code><c- g>config</c-></code></a>);

<c- b>partial</c-> <c- b>dictionary</c-> <a class="idl-code" data-link-type="dictionary" href="https://w3c.github.io/webrtc-pc/#dom-rtcconfiguration" id="ref-for-dom-rtcconfiguration①"><c- g>RTCConfiguration</c-></a> {
   <a class="n" data-link-type="idl-name" href="#callbackdef-encoderdecorator" id="ref-for-callbackdef-encoderdecorator①"><c- n>EncoderDecorator</c-></a> <a data-type="EncoderDecorator " href="#dom-rtcconfiguration-encoderfactory"><code><c- g>encoderFactory</c-></code></a>;
   <a class="n" data-link-type="idl-name" href="#callbackdef-decoderdecorator" id="ref-for-callbackdef-decoderdecorator①"><c- n>DecoderDecorator</c-></a> <a data-type="DecoderDecorator " href="#dom-rtcconfiguration-decoderfactory"><code><c- g>decoderFactory</c-></code></a>;
};

</pre>
  <aside class="dfn-panel" data-for="typedefdef-encoder">
   <b><a href="#typedefdef-encoder">#typedefdef-encoder</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-typedefdef-encoder">3. Specification {#specification}</a> <a href="#ref-for-typedefdef-encoder①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="typedefdef-decoder">
   <b><a href="#typedefdef-decoder">#typedefdef-decoder</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-typedefdef-decoder">3. Specification {#specification}</a> <a href="#ref-for-typedefdef-decoder①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-config">
   <b><a href="#dictdef-config">#dictdef-config</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-config">3. Specification {#specification}</a> <a href="#ref-for-dictdef-config①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="callbackdef-encoderdecorator">
   <b><a href="#callbackdef-encoderdecorator">#callbackdef-encoderdecorator</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-encoderdecorator">3. Specification {#specification}</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="callbackdef-decoderdecorator">
   <b><a href="#callbackdef-decoderdecorator">#callbackdef-decoderdecorator</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-decoderdecorator">3. Specification {#specification}</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

document.body.addEventListener("click", function(e) {
    var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
    // Find the dfn element or panel, if any, that was clicked on.
    var el = e.target;
    var target;
    var hitALink = false;
    while(el.parentElement) {
        if(el.tagName == "A") {
            // Clicking on a link in a <dfn> shouldn't summon the panel
            hitALink = true;
        }
        if(el.classList.contains("dfn-paneled")) {
            target = "dfn";
            break;
        }
        if(el.classList.contains("dfn-panel")) {
            target = "dfn-panel";
            break;
        }
        el = el.parentElement;
    }
    if(target != "dfn-panel") {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
            el.classList.remove("on");
            el.classList.remove("activated");
        });
    }
    if(target == "dfn" && !hitALink) {
        // open the panel
        var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
        if(dfnPanel) {
            dfnPanel.classList.add("on");
            var rect = el.getBoundingClientRect();
            dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
            dfnPanel.style.top = window.scrollY + rect.top + "px";
            var panelRect = dfnPanel.getBoundingClientRect();
            var panelWidth = panelRect.right - panelRect.left;
            if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                // Reposition, because the panel is overflowing
                dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
            }
        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
        }
    } else if(target == "dfn-panel") {
        // Switch it to "activated" state, which pins it.
        el.classList.add("activated");
        el.style.left = null;
        el.style.top = null;
    }

});
</script>